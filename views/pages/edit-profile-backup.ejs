<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= typeof title !== "undefined" ? title + " - " : "" %>Minerva Metrics Hub</title>
  
  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Google Fonts - Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  
  <!-- Custom Styles -->
  <link rel="stylesheet" href="/css/style.css">
  
  <style>
    body {
      font-family: "Inter", sans-serif;
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
  
  <!-- Navigation -->
  <%- include("../partials/navbar") %>
  
  <!-- Flash Messages -->
  <%- include("../partials/flash") %>
  
  <!-- Main Content -->
  <main class="flex-grow">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-4xl font-black text-gray-900 mb-2">
      Edit <span class="text-indigo-600">Profile</span>
    </h1>
    <p class="text-gray-600">Update your agency information and expertise</p>
  </div>

  <div class="grid lg:grid-cols-3 gap-8">
    <!-- Main Form -->
	    <div class="lg:col-span-2">
	      <div class="card">
        <form action="/profile/edit" method="POST" class="space-y-8">
          
	          <!-- Basic Information -->
	          <div>
            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
		              <span class="w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center text-white font-bold mr-3">1</span>
		              Basic Information
		            </h2>
		            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
	              <div>
	                <label class="form-label">
	                  Agency Name *
	                </label>
	                <input 
	                  type="text" 
	                  name="agency_name" 
	                  required 
	                  value="<%= agency.agency_name %>"
	                  class="form-input"
	                >
	              </div>
	
	              <div>
	                <label class="form-label">
	                  Contact Name *
	                </label>
	                <input 
	                  type="text" 
	                  name="contact_name" 
	                  required 
	                  value="<%= agency.contact_name %>"
	                  class="form-input"
	                >
	              </div>
	
	              <div>
	                <label class="form-label">
	                  Email Address
	                </label>
	                <input 
	                  type="email" 
	                  value="<%= agency.email %>" 
	                  disabled
	                  class="form-input bg-gray-100 text-gray-500 cursor-not-allowed"
	                >
	                <p class="text-sm text-gray-500 mt-2">
	                  <i class="fas fa-lock mr-1"></i>Email cannot be changed
	                </p>
	              </div>
	            </div>
	          </div>

	          <!-- Agency Details -->
	          <div class="border-t border-gray-200 pt-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
		              <span class="w-10 h-10 bg-emerald-500 rounded-full flex items-center justify-center text-white font-bold mr-3">2</span>
		              Agency Details
		            </h2>
		            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
	              <div>
	                <label class="form-label">
	                  <i class="fas fa-globe mr-2 text-indigo-600"></i>Website
	                </label>
	                <input 
	                  type="url" 
	                  name="website" 
	                  value="<%= agency.website || '' %>"
	                  placeholder="https://youragency.com"
	                  class="form-input"
	                >
	              </div>
	
	              <div>
	                <label class="form-label">
	                  <i class="fas fa-map-marker-alt mr-2 text-red-600"></i>Location
	                </label>
	                <input 
	                  type="text" 
	                  name="location" 
	                  value="<%= agency.location || '' %>"
	                  placeholder="City, Country"
	                  class="form-input"
	                >
	              </div>
	
	              <div>
	                <label class="form-label">
	                  <i class="fas fa-align-left mr-2 text-indigo-600"></i>Description
	                </label>
	                <textarea 
	                  name="description" 
	                  rows="6" 
	                  placeholder="Tell us about your agency, your expertise, and what makes you unique..."
	                  class="form-textarea"
	                ><%= agency.description || '' %></textarea>
	              </div>
	            </div>
	          </div>

	          <!-- Expertise -->
	          <div class="border-t border-gray-200 pt-8">
            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
		              <span class="w-10 h-10 bg-cyan-500 rounded-full flex items-center justify-center text-white font-bold mr-3">3</span>
		              Expertise
		            </h2>
		            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
	              <div>
	                <label class="form-label">
	                  <i class="fas fa-cogs mr-2 text-indigo-600"></i>Skills
	                </label>
	                <input 
	                  type="text" 
	                  name="skills" 
	                  value="<%= agency.skills || '' %>"
	                  placeholder="SEO, PPC, Social Media, Content Marketing"
	                  class="form-input"
	                >
	                <p class="text-sm text-gray-500 mt-2">Comma-separated list of your core services</p>
	              </div>
	
	              <div>
	                <label class="form-label">
	                  <i class="fas fa-chart-line mr-2 text-emerald-600"></i>Platforms
	                </label>
	                <input 
	                  type="text" 
	                  name="platforms" 
	                  value="<%= agency.platforms || '' %>"
	                  placeholder="Google Ads, Meta, TikTok, LinkedIn"
	                  class="form-input"
	                >
	                <p class="text-sm text-gray-500 mt-2">Advertising platforms you specialize in</p>
	              </div>
	
	              <div>
	                <label class="form-label">
	                  <i class="fas fa-industry mr-2 text-indigo-600"></i>Verticals
	                </label>
	                <input 
	                  type="text" 
	                  name="verticals" 
	                  value="<%= agency.verticals || '' %>"
	                  placeholder="E-commerce, SaaS, Healthcare, Finance"
	                  class="form-input"
	                >
	                <p class="text-sm text-gray-500 mt-2">Industries you have experience with</p>
	              </div>
	            </div>
	          </div>

	          <!-- Certifications -->
	          <div class="border-t border-gray-200 pt-8">
	            <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
	              <span class="w-10 h-10 bg-emerald-500 rounded-full flex items-center justify-center text-white font-bold mr-3">4</span>
	              Certifications
	            </h2>
	            <p class="text-gray-600 mb-6">Select any certifications your agency holds. This helps build trust with potential collaborators.</p>
	            
	            <div class="space-y-4">
	              <% const certificationOptions = [
	                'Google Partner',
	                'Meta Certified Professional',
	                'Microsoft Advertising Partner',
	                'TikTok Marketing Partner',
	                'LinkedIn Marketing Partner',
	                'HubSpot Agency Partner',
	                'Shopify Partner',
	                'Amazon Ads Certified',
	                'DV360 / GMP Certified',
	                'IAB Certifications'
	              ];
	              const agencyCerts = agency.certifications ? JSON.parse(agency.certifications) : []; %>
	              
	              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
	                <% certificationOptions.forEach(cert => { %>
	                  <label class="form-checkbox-label">
	                    <input 
	                      type="checkbox" 
	                      name="certifications" 
	                      value="<%= cert %>"
	                      <%= agencyCerts.includes(cert) ? 'checked' : '' %>
	                      class="form-checkbox"
	                    >
	                    <span class="ml-3 text-gray-700 font-medium"><%= cert %></span>
	                  </label>
	                <% }); %>
	              </div>
	              
	              <div class="mt-6">
	                <label class="form-label">
	                  <i class="fas fa-plus-circle mr-2 text-indigo-600"></i>Other Certifications
	                </label>
	                <input 
	                  type="text" 
	                  name="other_certifications" 
	                  placeholder="Add any other certifications not listed above"
	                  value="<%= (agencyCerts.filter(c => !certificationOptions.includes(c))).join(', ') || '' %>"
	                  class="form-input"
	                >
	                <p class="text-sm text-gray-500 mt-2">Comma-separated list of additional certifications</p>
	              </div>
	            </div>
	          </div>

	          <!-- Action Buttons -->
	          <div class="border-t border-gray-200 pt-8 flex flex-col sm:flex-row gap-4">
	            <button 
	              type="submit" 
	              class="btn btn-primary flex-1"
	            >
	              <i class="fas fa-save mr-2"></i>Save Changes
	            </button>
	            <a 
	              href="/dashboard" 
	              class="btn btn-secondary flex-1"
	            >
	              Cancel
	            </a>
	          </div>
        </form>
      </div>
    </div>

	    <!-- Sidebar -->
	    <div class="lg:col-span-1 space-y-6">
	      <!-- Subscription Card -->
	      <div class="card">
	        <h3 class="text-xl font-bold text-gray-900 mb-4 flex items-center">
	          <i class="fas fa-crown mr-2 text-amber-500"></i>Subscription
	        </h3>
	        
	        <div class="mb-6">
	          <div class="flex items-center justify-between mb-2">
	            <span class="text-gray-600">Current Plan</span>
	            <span class="font-bold text-xl capitalize
	              <%= agency.subscription_tier === 'premium' ? 'badge badge-premium' : '' %>
	              <%= agency.subscription_tier === 'pro' ? 'badge badge-primary' : '' %>
	              <%= agency.subscription_tier === 'free' ? 'badge badge-secondary' : '' %>
	            ">
	              <%= agency.subscription_tier %>
	            </span>
	          </div>
	          <div class="flex items-center justify-between">
	            <span class="text-gray-600">Status</span>
	            <span class="text-sm font-semibold capitalize text-emerald-600">
	              <%= agency.subscription_status %>
	            </span>
	          </div>
	        </div>

        <% if (agency.subscription_tier === 'free') { %>
          <a href="/subscriptions/checkout/pro" class="block w-full btn-gradient text-center">
            <i class="fas fa-arrow-up mr-2"></i>Upgrade to Pro
          </a>
        <% } else if (agency.subscription_tier === 'pro') { %>
          <a href="/subscriptions/checkout/premium" class="block w-full bg-gradient-to-r from-yellow-400 to-yellow-500 text-gray-900 py-3 px-6 rounded-xl font-bold text-center hover:from-yellow-500 hover:to-yellow-600 transition">
            <i class="fas fa-crown mr-2"></i>Upgrade to Premium
          </a>
        <% } else { %>
          <div class="text-center py-4">
            <i class="fas fa-check-circle text-green-500 text-3xl mb-2"></i>
            <p class="text-gray-600 font-semibold">You're on the best plan!</p>
          </div>
        <% } %>
      </div>

      <!-- Profile Stats -->
      <div class="bg-gradient-to-br from-purple-50 to-blue-50 rounded-2xl p-6 border-2 border-purple-200">
        <h3 class="text-lg font-bold text-gray-900 mb-4">Profile Stats</h3>
        <div class="space-y-3">
          <div class="flex items-center justify-between">
            <span class="text-gray-700 flex items-center">
              <i class="fas fa-star text-yellow-500 mr-2"></i>Rating
            </span>
            <span class="font-bold text-gray-900"><%= agency.rating_average.toFixed(1) %></span>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-gray-700 flex items-center">
              <i class="fas fa-comment text-blue-500 mr-2"></i>Reviews
            </span>
            <span class="font-bold text-gray-900"><%= agency.rating_count %></span>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-gray-700 flex items-center">
              <i class="fas fa-calendar text-green-500 mr-2"></i>Member Since
            </span>
            <span class="font-bold text-gray-900"><%= new Date(agency.created_at).getFullYear() %></span>
          </div>
        </div>
      </div>

      <!-- Help Card -->
      <div class="bg-blue-50 rounded-2xl p-6 border-2 border-blue-200">
        <i class="fas fa-info-circle text-blue-600 text-2xl mb-3"></i>
        <h3 class="font-bold text-blue-900 mb-2">Need Help?</h3>
        <p class="text-blue-800 text-sm mb-4">
          Make sure to fill out all fields to maximize your profile visibility and attract more collaboration opportunities.
        </p>
        <a href="#" class="text-blue-600 hover:text-blue-700 font-semibold text-sm">
          View Profile Tips <i class="fas fa-arrow-right ml-1"></i>
        </a>
      </div>
     </div>
  </div>
    </div>
  </main>
  
  <!-- Footer -->
  <%- include("../partials/footer") %>
  
</body>
</html>

